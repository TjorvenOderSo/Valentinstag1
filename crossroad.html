<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Cross The Road</title>
<style>
body{
  margin:0;
  overflow:hidden;
  background:#ffe0f0;
  font-family:sans-serif;
}
canvas{ display:block; }
#hud{
  position:absolute;
  top:10px;
  left:10px;
  font-size:22px;
  color:#ff4fa0;
}
</style>
</head>
<body>

<canvas id="game"></canvas>
<div id="hud">Herzen: 0 / 20</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let hearts = 0;
const target = 20;

let player = {x:canvas.width/2, y:canvas.height-60, size:30};

let cars = [];
for(let i=0;i<5;i++){
  cars.push({
    x: Math.random()*canvas.width,
    y: 100 + i*100,
    width: 80,
    height: 40,
    speed: 2 + Math.random()*2
  });
}

function drawPlayer(){
  ctx.fillStyle="#ff4fa0";
  ctx.fillRect(player.x, player.y, player.size, player.size);
}

function drawCars(){
  ctx.fillStyle="#444";
  cars.forEach(car=>{
    ctx.fillRect(car.x, car.y, car.width, car.height);
  });
}

function update(){
  cars.forEach(car=>{
    car.x += car.speed;
    if(car.x > canvas.width) car.x = -car.width;

    if(player.x < car.x + car.width &&
       player.x + player.size > car.x &&
       player.y < car.y + car.height &&
       player.y + player.size > car.y){
         player.y = canvas.height-60;
         hearts = 0;
    }
  });

  if(player.y < 0){
    hearts++;
    player.y = canvas.height-60;
  }

  if(hearts >= target){
    setTimeout(()=>{ location.href="finalstory.html"; },500);
  }

  document.getElementById("hud").innerText = `Herzen: ${hearts} / ${target}`;
}

document.addEventListener("keydown",(e)=>{
  if(e.key==="ArrowUp") player.y -= 40;
  if(e.key==="ArrowDown") player.y += 40;
  if(e.key==="ArrowLeft") player.x -= 40;
  if(e.key==="ArrowRight") player.x += 40;
});

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawCars();
  drawPlayer();
  update();
  requestAnimationFrame(draw);
}

draw();
</script>
</body>
</html>
