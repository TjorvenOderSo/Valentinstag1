<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>SkyJump</title>
<style>
body{ margin:0; overflow:hidden; background:linear-gradient(#111,#333);}
canvas{ display:block; }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Gravitation & Sprungkraft anpassen
let gravity = 0.4;       // etwas sanfter als vorher
let jumpStrength = 10;   // kontrollierter Sprung

let hearts = 0;
let targetHearts = 40;

// Ball
let ball = {x: canvas.width/2, y: canvas.height-50, radius:20, dy:0};

// Plattformen
let platforms = [];

// Startplattform ganz unten
platforms.push({x: canvas.width/2 - 50, y: canvas.height - 30, width:100, height:15, start:true});

// Weitere Plattformen
for(let i=1;i<8;i++){
  platforms.push({x:Math.random()*(canvas.width-100), y:canvas.height - i*100, width:100, height:15, start:false});
}

function drawBall(){
  ctx.fillStyle="#ff4fa0";
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.radius,0,Math.PI*2);
  ctx.fill();
}

function drawPlatforms(){
  ctx.fillStyle="#888";
  platforms.forEach(p=>ctx.fillRect(p.x,p.y,p.width,p.height));
}

function update(){
  ball.dy += gravity;
  ball.y += ball.dy;

  platforms.forEach((p, index)=>{
    // Plattform-Kollision nur, wenn Ball von oben kommt
    if(ball.x > p.x && ball.x < p.x + p.width && 
       ball.y + ball.radius > p.y && ball.y + ball.radius < p.y + 15 && 
       ball.dy > 0){

      ball.dy = -jumpStrength;
      hearts++;

      // Startplattform entfernen, sobald man die erste „normale“ Plattform berührt
      if(p.start){
        platforms.splice(index,1);
      }
    }
  });

  // Scroll-Effekt: Ball immer in der Mitte halten
  if(ball.y < canvas.height/2){
    let diff = canvas.height/2 - ball.y;
    ball.y = canvas.height/2;
    platforms.forEach(p=>{
      p.y += diff;
      if(p.y > canvas.height){
        p.y = 0;
        p.x = Math.random()*(canvas.width-100);
      }
    });
  }

  // Herz-Ziel erreicht
  if(hearts >= targetHearts){
    setTimeout(()=>{location.href="afterskyjump.html"},500);
  }

  // Ball fällt nach unten
  if(ball.y > canvas.height){
    ball.y = canvas.height - 50;
    ball.dy = 0;
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBall();
  drawPlatforms();
  ctx.fillStyle="white";
  ctx.font="22px Arial";
  ctx.fillText("Herzen: "+hearts+" / "+targetHearts,20,40);
  update();
  requestAnimationFrame(draw);
}

draw();

// Ball mit Maus bewegen
document.addEventListener("mousemove",(e)=>{ball.x=e.clientX});
</script>

</body>
</html>
